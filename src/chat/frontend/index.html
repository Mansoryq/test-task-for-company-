<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Avito Messages (Local)</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
    #messages { margin-top: 20px; }
    .message { background: white; padding: 10px; margin-bottom: 10px; border-radius: 4px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
    .from { font-weight: bold; color: #1a73e8; }
    .text { margin-top: 4px; }
    .time { font-size: 0.8em; color: #888; }
  </style>
</head>
<body>
  <h1>üì© –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –†—É—à–∞–Ω–∞ (–ª–æ–∫–∞–ª—å–Ω–æ)</h1>
  <div id="status">–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket...</div>
  <div id="messages"></div>

  <script>
    const ws = new WebSocket('ws://localhost:3000');
    const statusEl = document.getElementById('status');
    const messagesEl = document.getElementById('messages');

    ws.onopen = () => {
      statusEl.textContent = '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —Å–µ—Ä–≤–µ—Ä—É';
      statusEl.style.color = 'green';
    };

    ws.onmessage = (event) => {
      const msg = JSON.parse(event.data);
      const div = document.createElement('div');
      div.className = 'message';
      div.innerHTML = `
        <div class="from">–û—Ç: ${msg.from}</div>
        <div class="text">${msg.text}</div>
        <div class="time">${new Date(msg.timestamp).toLocaleString()}</div>
      `;
      messagesEl.prepend(div);
    };

    ws.onerror = () => {
      statusEl.textContent = '‚ùå –û—à–∏–±–∫–∞ WebSocket';
      statusEl.style.color = 'red';
    };

    ws.onclose = () => {
      statusEl.textContent = 'üîå –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ';
      statusEl.style.color = 'orange';
    };
  </script>
</body>
</html>